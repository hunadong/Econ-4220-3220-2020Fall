\documentclass{article}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
\setlength{\parindent}{0pt}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,
    linkcolor=blue,
    filecolor=magenta,      
    urlcolor=cyan}
\usepackage{graphicx}
\graphicspath{ {./pic/} }
\usepackage{multicol}
\usepackage{lscape}

\usepackage{fourier,amssymb,microtype,amsmath,gensymb}
\newcommand{\R}{\mathbb{R}}
\usepackage{mdframed,caption,xcolor}
\usepackage{tikz,tkz-euclide}

\title{Seminar 3.Duality of Consumers Behavior}
\author{Xiaoguang Ling \\  \href{xiaoguang.ling@econ.uio.no}{xiaoguang.ling@econ.uio.no}}
\date{\today}

\begin{document}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{landscape}
\section*{Consumption Duality}

\begin{mdframed}[backgroundcolor=yellow!20,linecolor=white]

You will never lose your way with this Consumption Duality map!

All "derive this from that and verify some guy's equation"-like questions can be
solved by finding the correct (shortest) route.
\end{mdframed}
\vspace{3mm}
{\scriptsize
\usetikzlibrary{arrows.meta}
\tikzset{%
  >={Latex[width=1mm,length=1mm]},
  % Specifications for style of nodes:
            base/.style = {rectangle, rounded corners, draw=black,
                           minimum width=2cm, minimum height=1cm,
                           text centered, font=\sffamily},
  Starts/.style = {base, fill=blue!30},
         process/.style = {base, minimum width=2.5cm, fill=orange!15,
                           font=\ttfamily},
}
\begin{tikzpicture}[node distance=2cm,
every node/.style={fill=white, font=\sffamily}, align=center]
\node (start) [Starts] {Utility Maximization: \\ $\max_{x \in \R^n_+} \ u(x), s.t.  px \le y$};
\node (1) [process, below of=start] {Marshallian Demand: \\ \ $x(p,y)$};
\node (2) [process, below of=1] {Indirect Utility: \\ $v(p,y) = u[x(p,y)]$};
\node (3) [process, left of=2,xshift=-1.5cm,yshift=1cm]  {Roy's Identity(pp.29): \\ $x_i(p^0,y^0) = - \frac{\partial v(p^0,y^0) / \partial p_i}{\partial v(p^0,y^0) / \partial y}$};
\node (4) [process, below of=2] {Direct Utility (pp.82): \\ $u(x) = \min_{p \in \R^n_{++}}  v(p,1), s.t. px=1$};
\node (5) [process, below of=4] {Inverse Demands: \\ $p_i(x)$};

\node (6) [process, left of=5,xshift=-1.5cm,yshift=1cm] {Hotelling, Wold (pp.84) \\ $p_i(x) = \frac{\partial u(x) / \partial x_i}{\Sigma^{n}_{j=1} x_j( \partial u(x) / \partial x_j)}$};

\draw[->]  (start) -- (1);
\draw[->] (1) -- (2);
\draw[dashed]  (2) --  (3);
\draw[dashed]  (3) --  (1);
\draw[->] (2) --  (4);
\draw[->] (4) --  (5);
\draw[dashed]  (4) --  (6);
\draw[dashed]  (6) --  (5);



{\tiny
\path (start) to  node {solution $x^*$} (1); 
\path (1) to  node {maximized value} (2); 
\path (4) to  node {solution $p^*$} (5); 
}
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\node (start2) [Starts, right of = 1, xshift =9cm, yshift=2cm] {Expenditure Minimization: \\ $\min_{x \in \R^n_+} \ px, s.t. u \ge \bar{u}$};
\node (21) [process, below of=start2] {Hicksian Demand: \\ $x^h(p,\bar{u})$};
\node (22) [process, below of=21] {Expenditure: \\ $e(p,\bar{u}) = px^h(p,\bar{u})$};
\node (23) [process, right of=22,xshift=1.5cm,yshift=1cm]  {Shephard's lemma(pp.37): \\ $\frac{\partial e(p^0,u^0)}{\partial p_i} = x^h(p^0,u^0)$};
\node (24) [process, below of=22] {Direct Utility (pp.75): \\ $u(x) \equiv max\{u \le 0 | x \in A(u) \}$};
\draw[->]  (start2) -- (21);
\draw[->]  (21) -- (22);
\draw[dashed]  (22) --  (23);
\draw[dashed]  (23) --  (21);
\draw[->] (22) --  (24);
{\tiny
\path (start2) to  node {solution $x^*$} (21); 
\path (21) to  node {minimized value} (22); 
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\node (31) [process, right of=1,xshift=3.5cm,yshift=2cm] {Slutsky equation(pp.53): \\ $\frac{\partial x_i(p,y)}{\partial p_j} = \frac{\partial x_i^h(p,u^*)}{\partial p_j} - x_j(p,y)\frac{\partial x_i(p,y)}{\partial y}$};
\node (32) [process, below of=31,yshift=-4cm] {$e[p,v(p,y)] = y$ \\ $v[p,e(p,u)] = u$};
\draw[dashed]  (1) --  (31);
\draw[dashed]  (31) --  (21);
\draw[<-]  (2) --  (32);
\draw[->]  (32) --  (22);
\draw[-,blue]   (21) -- (2.north east);
\draw [->,blue] (2.north east) -- (1) ;
\path (21) to  node[below, sloped, xshift=-3cm] {$x(p,y) = x^h[p,v(p,y)]$}  (2.north east); 

\draw[-,red]   (22.north west) -- (1);
\draw [->,red] (22.north west) -- (21) ;
\path (1) to  node[below, sloped, xshift=3cm] {$x^h(p,\bar{u}) = x[p,e(p,\bar{u})]$}  (22.north west); 


\end{tikzpicture}
}
\end{landscape}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Jehle \& Reny 2.3}
Derive the consumerâ€™s direct utility function if his indirect utility function has the form $v(p, y) =
yp_1^\alpha p_2^\beta$ for negative $\alpha$ and $\beta$.

\begin{mdframed}[backgroundcolor=blue!20,linecolor=white]

\textbf{THEOREM 2.3 Duality Between Direct and Indirect Utility}(Jehle \& Reny pp.81 )

Suppose that $u(x)$ is quasiconcave and differentiable on $\R^n_{++}$ with strictly positive partial derivatives there. Then for all $x \in \R^n_{++}$ , $v(p, p \cdot x)$, the indirect utility function generated
by $u(x)$, achieves a minimum in $p$ on $\R^n_{++}$, and

$$u(x) = \min_{p \in \R^n_{++}}  v(p,y), s.t. px=y$$

Let's call the solution $p^*$

Note that by \textbf{Theorem 1.6}(Jehle \& Reny pp.29), $v(p, y)$ is homogeneous of degree zero in $(p, y)$. We have $v(p, p \cdot x) = v(p/(p \cdot x), 1)$ whenever $p \cdot x > 0$. Thus the equation above can also be written as:

$$u(x) = \min_{p \in \R^n_{++}}  v(p,1), s.t. px=1$$

The solution $\hat{p} = p^* / p^* \cdot x = p^* / y$. We don't care about the difference between $\hat{p}$ and $p^*$ because once you substitute them into $v(p,p\cdot x)$, you have the same result (homogeneity of degree zero).

\vspace{3mm}

\textcolor{red}{Besides, homogeneous of degree zero in $(p, y)$ also indicates $\alpha + \beta = -1$ because:
$$v(tp, ty) =
ty(tp_1^\alpha) (tp_2)^\beta = t^{1+\alpha + \beta}v(p, y)$$}

\end{mdframed}

$$u(x) = \min_{p \in \R^n_{++}}  v(p, 1) =
p_1^\alpha p_2^\beta, s.t. px=1$$

Lagrangian:

$$L = p_1^\alpha p_2^\beta + \lambda (1- p_1x_1 - p_2x_2)$$

Note there should not be corner solution since

\begin{itemize}
\item $Since \alpha, \beta < 0, p$ can't be $0$.

\item You can also argue $\frac{\partial v(p_1,p_2,1)}{\partial p_i} = - \infty, i=1,2$

\item $v(p,1)$ is decreasing in $p$(this is always true for indirect utility function, see pp.29). For any $px<1$, you can always decrease $v(p, 1)$ by increasing $p$ until $px = 1$.
\end{itemize}

FOCs.

\begin{equation}
    \begin{cases}
\frac{\partial L}{\partial p_1} = \alpha p_1^{\alpha - 1} p_2^\beta - \lambda x_1= 0 \\
\frac{\partial L}{\partial p_2} = p_1^{\alpha} \beta p_2^{\beta - 1} - \lambda x_2 = 0 \\
p_1x_1 + p_2x_2 = 1
    \end{cases}
    \nonumber
\end{equation}

Simplify:

\begin{equation}
    \begin{cases}
 \alpha p_1^{\alpha - 1} p_2^\beta = \lambda x_1 \\
 \beta  p_1^{\alpha}  p_2^{\beta - 1} = \lambda x_2  \\
p_1x_1 + p_2x_2 = 1
    \end{cases}
    \label{eq:2_3_foc}   
\end{equation}

Take the ratio between first and second condition to get:

$$\frac{x_1}{x_2} = \frac{\alpha}{\beta} \frac{p_2}{p_1}$$

Thus: $p_2 = \frac{\beta}{\alpha}\frac{x_1}{x_2} p_1 $

Substitute $p_2$ with $p_1$ in the 3rd condition to get:

\textcolor{red}{\begin{align*}
p_1x_1 + \frac{\beta}{\alpha}\frac{x_1}{x_2} p_1  x_2 &= 1 \\
p_1(x_1 + \frac{\beta}{\alpha} x_1) &= 1 \\
p_1^* &= \frac{1}{x_1(1+ \frac{\beta}{\alpha})} \\
p_1^* &= \frac{\alpha}{x_1(\alpha+ \beta)} \\
p_1^* &= -\frac{\alpha}{x_1} \\
\Rightarrow p_2^* &= \frac{\beta}{\alpha} \frac{x_1}{x_2} p_1 =\frac{\beta}{\alpha} \frac{x_1}{x_2}(-\frac{\alpha}{x_1}) = -\frac{\beta}{x_2}
\end{align*}}

Substitute $p^*_1$ and $p^*_2$ into $v(p,1)$ we get the minimized value, i.e. the direct utility function:

\begin{align*}
u(x_1.x_2) &= [-\frac{\alpha}{x_1}]^\alpha[-\frac{\beta}{x_2}]^\beta \\
 &= A x_1^a x_2^b
\end{align*}

\textcolor{red}{
Where $A = [-\alpha]^\alpha[-\beta]^\beta$ ,$a = -\alpha >0$ , $b= -\beta > 0$. The utility function is a Cobb-Douglas function.}

\begin{mdframed}[backgroundcolor=yellow!20,linecolor=white]
As a cautious proof, you may want to check if $u(x)$ is quasiconcave and differentiable on $\R^n_{++}$ with strictly positive partial derivatives there, as assumed by Theorem 2.3. 

In exam for this course, again, if the function is one- dimension, you should prove it; if it's a higher-dimension function, the proof is not required.
\end{mdframed}

\begin{mdframed}[backgroundcolor=blue!20,linecolor=white]
\textcolor{red}{
\textbf{Alternative 1:
\vspace{2mm}
You can use Roy's Identity(Jehle \& Reny pp.29): $$x_i(p^0,y^0) = - \frac{\partial v(p^0,y^0) / \partial p_i}{\partial v(p^0,y^0) / \partial y}$$
to get Marshallian demands directly (Note here $p^*_i = \frac{p_i}{y}$):
\begin{equation}
    \begin{cases}
    x_1 = - \frac{\alpha}{p^*_1} \\
    x_2 = - \frac{\beta}{p^*_1}
    \end{cases}
\nonumber
\end{equation}}
\vspace{2mm}
Then solve the Inverse demand from Marshallian demands:
\begin{equation}
    \begin{cases}
  p_1^* &= -\frac{\alpha}{x_1} \\
  p_2^* &= -\frac{\beta}{x_1} \\
    \end{cases}
\nonumber
\end{equation}
Substitute into $v(p,1)$ you'll have the same solution.
}


\vspace{2mm}

\textbf{Alternative 2:}
\vspace{2mm}
Like Jehle \& Reny 1.51, you can actually transform $v(p_1,p_2,1)$  into a function of only $p_1$ or $p_2$ using $p_1x_1 + p_2x_2 = 1$.

$$p_1 = \frac{1 - p_2x_2}{x_1}$$

Substitute into  $v(p_1,p_2,1)$ to have:
$$v(p_1,p_2,1) = [\frac{1 - p_2x_2}{x_1}]^\alpha p_2^\beta$$

Since the question ask you to minimize $v(p_1,p_2,1)$, if you solve $\frac{d e(p_2)}{d p_2} = 0$ and get only one solution, it is the solution.

\begin{align*}
\frac{d e(p_2)}{d p_2} =  \alpha(\frac{1-p_2x_2}{x_1})^{\alpha -1}(\frac{-x_2}{x_1})p_2^\beta +  \frac{1 - p_2x_2}{x_1}^\alpha \beta p_2^{\beta -1} &= 0 \\
 \alpha(\frac{1-p_2x_2}{x_1})^{\alpha -1}(\frac{x_2}{x_1})p_2^\beta &= \frac{1 - p_2x_2}{x_1}^\alpha \beta p_2^{\beta -1} \\
 \alpha(\frac{x_1}{1-p_2x_2})(\frac{x_2}{x_1})p_2 &= \beta  \\
\alpha(\frac{x_2}{1-p_2x_2}) p_2 &= \beta  \\
\alpha x_2 p_2 &= \beta-\beta x_2 p_2  \\
(\alpha x_2 + \beta x_2) p_2&= \beta  \\
 p^*_2&= \frac{\beta}{(\alpha + \beta)x_2} 
\end{align*}
You then solve $p^*_1$ with the budget constraint.
\end{mdframed}



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Jehle \& Reny 2.5(a)}
Consider the solution, $e(p, u) = up_1^{\alpha_1}p_2^{\alpha_2}p_3^{\alpha_3}$ at the end of Example 2.3.
Derive the \textbf{indirect utility function} through the relation $e(p, v(p, y)) = y$ and verify Roy's identity.

\vspace{3mm}

\begin{mdframed}[backgroundcolor=blue!20,linecolor=white]
Example 2.3 on Jehle \& Reny pp.90 is a question from $x_i(p,y)$ to $e(p,u)$, where the Marshallian demand function is:
$$x_i(p_1,p_2,p_3,y) = \frac{\alpha_i y}{p_i} , \ i=1,2,3$$
 $\alpha_i >0$ and $\alpha_1+\alpha_2+\alpha_3 = 1$

Check your map, the route is (note the expression below is only for the purpose of teaching and very informal):
$$x_i(p,y) \Rightarrow x^h(p,u) = x[p,e(p,u)] \Leftarrow \frac{\partial e(p,u)}{\partial p_i} = x^h(p,u)$$

\begin{align*}
x[p,e(p,u)] &=  \frac{\partial e(p,u)}{\partial p_i} \\
\frac{\alpha_i e(p,u)}{p_i} &=  \frac{\partial e(p,u)}{\partial p_i} \\
\frac{\alpha_i }{p_i} &=  \frac{1}{e(p,u)}\frac{\partial e(p,u)}{\partial p_i} \\
&=  \frac{\partial ln[e(p,u)]}{\partial p_i}
\end{align*}

The rest part of the solution in the textbook is clear. Read page 91 if you're curious how we solve $e(p,u)$ out. It need "a little thought" as the textbook said :)

\end{mdframed}


\textbf{Indirect utility function}:

We already know $e(p, v(p, y)) = y$.

Substitute $v(p, y)$ into $e(p, u) = y$ will solve the question directly:

$$e(p, u) = v(p, y) p_1^{\alpha_1}p_2^{\alpha_2}p_3^{\alpha_3} = y$$
$$\Rightarrow v(p, y) = \frac{y}{p_1^{\alpha_1}p_2^{\alpha_2}p_3^{\alpha_3}}$$

\textbf{Verify Roy's identity}:

\begin{mdframed}[backgroundcolor=blue!20,linecolor=white]
Roy's Identity(Jehle \& Reny pp.29): $$x_i(p^0,y^0) = - \frac{\partial v(p^0,y^0) / \partial p_i}{\partial v(p^0,y^0) / \partial y}$$

\textbf{Intuition}:Your optimal consumption plan (Marshallian demand) is a trade- off between the importance of "comodity $i$" and "money ($y$)".

\end{mdframed}

$$\frac{\partial v(p,y)} {\partial p_1} = \frac{\partial yp_1^{-\alpha_1}p_2^{-\alpha_2}p_3^{-\alpha_3}}{\partial p_1} =  -\alpha_1 yp_1^{-\alpha_1 -1}p_2^{-\alpha_2}p_3^{-\alpha_3}$$
$$\frac{\partial v(p,y)} {\partial p_2} =  -\alpha_3 yp_1^{-\alpha_1}p_2^{-\alpha_2-1}p_3^{-\alpha_3}$$
$$\frac{\partial v(p,y)} {\partial p_3} =  -\alpha_3 yp_1^{-\alpha_1}p_2^{-\alpha_2}p_3^{-\alpha_3-1}$$
$$\frac{\partial v(p,y)} {\partial y} = p_1^{-\alpha_1}p_2^{-\alpha_2}p_3^{-\alpha_3}$$

Therefore:

$$-\frac{\partial v(p,y) / \partial p_1}{\partial v(p,y) / \partial y} =-\frac{-\alpha_1 yp_1^{-\alpha_1 -1}p_2^{-\alpha_2}p_3^{-\alpha_3}}{p_1^{-\alpha_1}p_2^{-\alpha_2}p_3^{-\alpha_3}} = \frac{\alpha_1 y}{p_1}$$

$$-\frac{\partial v(p,y) / \partial p_2}{\partial v(p,y) / \partial y} =-\frac{-\alpha_3 yp_1^{-\alpha_1}p_2^{-\alpha_2-1}p_3^{-\alpha_3}}{p_1^{-\alpha_1}p_2^{-\alpha_2}p_3^{-\alpha_3}} = \frac{\alpha_2 y}{p_1}$$

$$-\frac{\partial v(p,y) / \partial p_3}{\partial v(p,y) / \partial y} =-\frac{ -\alpha_3 yp_1^{-\alpha_1}p_2^{-\alpha_2}p_3^{-\alpha_3-1}}{p_1^{-\alpha_1}p_2^{-\alpha_2}p_3^{-\alpha_3}} = \frac{\alpha_3 y}{p_1}$$

Compare with the Marshallian demand!

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Jehle \& Reny 2.7}
Derive the consumer's \textbf{inverse demand functions}, $p_1(x_1, x_2)$ and $p_2(x_1, x_2)$, when the \textbf{utility function} is of the Cobb-Douglas form, $u(x_1, x_2) = Ax_1^{\alpha}x_2^{1-\alpha}$ for $0 < \alpha < 1$.

\begin{mdframed}[backgroundcolor=blue!20,linecolor=white]
The shortest route is using Hotelling, Wold (pp.84) directly.

$$p_i(x) = \frac{\partial u(x) / \partial x_i}{\Sigma^{n}_{j=1} x_j( \partial u(x) / \partial x_j)}$$

\textbf{Intuition}: the price reflects how important the commodity is.

\vspace{3mm}


The duality between direct and indirect utility functions showed by Hotelling, Wold makes it (hopefully) easier to solve $p_i^*(x)$
\end{mdframed}

\begin{align*}
p_1(x_1,x_2) &=  \frac{\partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_1}{\Sigma^{2}_{j=1} x_j( \partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_j)} \\
&=\frac{\partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_1}{x_1 \partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_1 + x_2  \partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_2} \\
&=\frac{A\alpha x_1^{\alpha -1}x_2^{1-\alpha}}{x_1 A\alpha x_1^{\alpha -1}x_2^{1-\alpha} + x_2A(1-\alpha) x_1^{\alpha}x_2^{-\alpha}} \\
&=\frac{\alpha x_1^{\alpha -1}x_2^{1-\alpha}}{\alpha x_1^{\alpha}x_2^{1-\alpha} + (1-\alpha) x_1^{\alpha}x_2^{1-\alpha}} \\
&=\frac{\alpha}{x_1}
\end{align*}

\begin{align*}
p_2(x_1,x_2) &=  \frac{\partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_2}{\Sigma^{2}_{j=1} x_j( \partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_j)} \\
&=\frac{\partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_2}{x_1 \partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_1 + x_2  \partial (Ax_1^{\alpha}x_2^{1-\alpha}) / \partial x_2} \\
&=\frac{A(1-\alpha) x_1^{\alpha}x_2^{-\alpha}}{x_1 A\alpha x_1^{\alpha -1}x_2^{1-\alpha} + x_2A(1-\alpha) x_1^{\alpha}x_2^{-\alpha}} \\
&=\frac{(1-\alpha) x_1^{\alpha}x_2^{-\alpha}}{\alpha x_1^{\alpha}x_2^{1-\alpha} + (1-\alpha) x_1^{\alpha}x_2^{1-\alpha}} \\
&=\frac{1-\alpha}{x_2}
\end{align*}

\begin{mdframed}[backgroundcolor=blue!20,linecolor=white]
You can also try another route: maximize $u(x) \Rightarrow x(p,y) \Rightarrow p_i(x) = x^{-1}(x,1)$

Use Lagrangian to maximize $u(x_1, x_2) = Ax_1^{\alpha}x_2^{1-\alpha}$
s.t. $p_1x_2 + p_2x_2 = 1$. The solution (Marshallian demands) is:

\begin{equation}
    \begin{cases}
x_1 = \frac{\alpha}{p_1} \\
x_2 = \frac{1-\alpha}{p_2}
    \end{cases}
\nonumber
\end{equation}

The inverse of Marshallian demand function gives the inverse demand function

\begin{equation}
    \begin{cases}
p_1 = \frac{\alpha}{x_1} \\
p_2 = \frac{1-\alpha}{x_2}
    \end{cases}
\nonumber
\end{equation}

Another example:
\begin{itemize}
\item You can also try to derive $p_i(x)$ from the Marshallian demand E.1 on pp. 32 and compare with the result derived from Hotelling-Wold identity on pp. 85. Both of them should be the same as E.5-E.6 on pp. 83, which is the solution for $v(p,1)$ minimization problem.
\end{itemize}


\end{mdframed}








\end{document}
